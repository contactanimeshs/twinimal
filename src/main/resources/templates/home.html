<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.w3.org/1999/xhtml">
<head>
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-BF5T0LWQV6"></script>
    <script>
window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-BF5T0LWQV6');

    </script>
    <meta charset="UTF-8">
    <meta content="IE=edge" http-equiv="X-UA-Compatible">
    <meta content="width=device-width, initial-scale=1.0" name="viewport">
    <link crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css"
          integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" rel="stylesheet">
    <script crossorigin="anonymous"
            integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM"
            src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
    <link rel="stylesheet" th:href="@{/css/main.css}"/>
    <title>Twinimal | Home</title>
    <link rel='icon' th:href="@{favicon.png}" type='image/png'/>
    <script type="javascript">

    </script>

</head>
<body>
<button id="scrolltopbtn" onclick="topFunction()">+</button>
<div class="container centrifiedcontainerhome">
    <header>
        <!-- <div class="twilogodiv navbar"> -->
        <div class="navbartop">
            <div class="dropdown">
                <i aria-expanded="false" class="tweetoptionicon bi bi-three-dots-vertical" data-bs-toggle="dropdown"
                   role="button"></i>
                <ul class="dropdown-menu">
                    <li>
                        <form method="get" th:action="@{/logout}">
                            <button class="dropdown dropdown-item alert-danger" type="submit">
                                <i class="bi bi-box-arrow-right"></i> Logout
                            </button>
                        </form>
                    </li>
                    <!--        <li><a class="dropdown-item disabled" href="#"><i class="bi bi-clipboard"></i>  Copy</a></li>-->
                    <!--        <li><a class="dropdown-item disabled" href="#"><i class="bi bi-share-fill"></i>  Share</a></li>-->
                </ul>
            </div>
            <p class="twinimallogo">twinimal</p>
            <!-- <p><svg class="twilogobirdnavbar" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M24 4.557c-.883.392-1.832.656-2.828.775 1.017-.609 1.798-1.574 2.165-2.724-.951.564-2.005.974-3.127 1.195-.897-.957-2.178-1.555-3.594-1.555-3.179 0-5.515 2.966-4.797 6.045-4.091-.205-7.719-2.165-10.148-5.144-1.29 2.213-.669 5.108 1.523 6.574-.806-.026-1.566-.247-2.229-.616-.054 2.281 1.581 4.415 3.949 4.89-.693.188-1.452.232-2.224.084.626 1.956 2.444 3.379 4.6 3.419-2.07 1.623-4.678 2.348-7.29 2.04 2.179 1.397 4.768 2.212 7.548 2.212 9.142 0 14.307-7.721 13.995-14.646.962-.695 1.797-1.562 2.457-2.549z"/></svg></p> -->
        </div>
    </header>
    <div class="form-group tweetinputdiv">
        <form action="/tweet" method="post">
            <textarea class="form-control tweetinput" id="exampleFormControlTextarea1" name="text" required
                      rows="4" spellcheck="true"></textarea>
            <button class="tweetbtn" type="submit">Tweet</button>
        </form>
    </div>
    <form method="get" th:action="@{/bookmarks}">
        <div class="d-grid gap-2">
        <button class="btn btn-secondary bookmarkbtn">
            Manage Bookmarks <i class="bi bi-bookmarks-fill"></i>
        </button>
        </div>
    </form>
    <tr th:each="currentTweet : ${previoustweets}">
        <td>
            <div class="tweet" id="tweet">
                <div class="dropdown">
                    <i aria-expanded="false" class="tweetoptionicon bi bi-three-dots-vertical" data-bs-toggle="dropdown"
                       role="button"></i>
                    <ul class="dropdown-menu">
                        <li>
                            <form method="post" th:action="@{/delete}">
                                <button class="dropdown dropdown-item alert-danger" th:name="tweetId" th:value="${currentTweet.getId()}"
                                        type="submit">
                                    <i class="bi bi-trash2-fill"></i> Delete
                                </button>
                                </button>
                            </form>
                        </li>
                        <li><a class="dropdown-item disabled" href="#"><i class="bi bi-clipboard"></i> Copy</a></li>
                        <li><a class="dropdown-item disabled" href="#"><i class="bi bi-share-fill"></i> Share</a></li>
                    </ul>
                </div>
                <div class="userinfodiv">
                    <img id="profilepic" th:src="${photo}">
                    <div class="usernamediv">
                        <h6 th:text="${name}"></h6>
                        <p th:text="${username}"><small></small></p>
                    </div>
                </div>
                <p id="tweetcontent" th:text="${currentTweet.getText()}"></p>
                <!--        <img class="img-fluid tweetimg" src="https://images.pexels.com/photos/347141/pexels-photo-347141.jpeg?auto=compress&cs=tinysrgb&w=1260&h=750&dpr=1">-->
            </div>
        </td>
    </tr>


    <!-- <div class="tweet" id="tweet">
        <div class="dropdown">
            <i class="tweetoptionicon bi bi-three-dots-vertical" role="button" data-bs-toggle="dropdown" aria-expanded="false"></i>
            <ul class="dropdown-menu">
              <li><a class="dropdown-item alert-danger" href="#"><i class="bi bi-trash2-fill"></i> Delete</a></li>
              <li><a class="dropdown-item" href="#"><i class="bi bi-clipboard"></i>  Copy</a></li>
              <li><a class="dropdown-item" href="#"><i class="bi bi-share-fill"></i>  Share</a></li>
            </ul>
            <p id="tweetcontent">Setting up my Twitter! using #Twinimal :)</p>
          </div>
    </div>


    <div class="tweet" id="tweet">
        <div class="dropdown">
            <i class="tweetoptionicon bi bi-three-dots-vertical" role="button" data-bs-toggle="dropdown" aria-expanded="false"></i>
            <ul class="dropdown-menu">
              <li><a class="dropdown-item alert-danger" href="#"><i class="bi bi-trash2-fill"></i> Delete</a></li>
              <li><a class="dropdown-item" href="#"><i class="bi bi-clipboard"></i>  Copy</a></li>
              <li><a class="dropdown-item" href="#"><i class="bi bi-share-fill"></i>  Share</a></li>
            </ul>
            <p id="tweetcontent">Exploring the serene Manali...</p>
            <div class = "twoimgrow">
            <img class="tweetimg2 img-fluid" src="https://images.pexels.com/photos/2901209/pexels-photo-2901209.jpeg?auto=compress&cs=tinysrgb&w=1260&h=750&dpr=1">
            <img class="tweetimg2 img-fluid" src="https://images.pexels.com/photos/570026/pexels-photo-570026.jpeg?auto=compress&cs=tinysrgb&w=1260&h=750&dpr=1">
            </div>
          </div> -->

</div>

<script>

    //Get the button
var mybutton = document.getElementById('scrolltopbtn');

// When the user scrolls down 20px from the top of the document, show the button
window.onscroll = function() {scrollFunction()};

window.onload = function()
 {
    var scrollHeight, totalHeight;
    scrollHeight = document.body.scrollHeight;
    totalHeight = window.scrollY + window.innerHeight;

    if(totalHeight >= scrollHeight)
    {
        console.log("at the bottom");
        addNewOnPageEnd();
    }

let myhtml = $('ul').html();
const mytypes = myhtml.match(/(@|#)+[^\s<\.]+/g);

const myReplace = (mytype) => {
  const isat = mytype.includes('@');
  const replacestring = `<span class="${isat ? 'at' : 'hash'}">${mytype}</span>`;
  myhtml = myhtml.replace(mytype, replacestring);
};

mytypes.forEach(el => myReplace(el));
$('p').html(myhtml);

}

window.onload = function() {addNewOnPageEnd()};

function addNewOnPageEnd() {
    console.log('pg loaded');

    for (let index = 0; index < 10; index++) {

<!--        duplicate();-->

    }
}


function scrollFunction() {
if (document.body.scrollTop > 40 || document.documentElement.scrollTop > 40) {
    // mybutton.style.display = "block";
    mybutton.style.opacity = "1.0";
    mybutton.style.transition = "all 1.5s ease 0s";
    mybutton.style.transform = "translateY(-7px)";

} else {
    // mybutton.style.display = "none";
    mybutton.style.opacity = "0";
}
}

// When the user clicks on the button, scroll to the top of the document
function topFunction() {
document.body.scrollTop = 0;
document.documentElement.scrollTop = 0;
}

function duplicate() {
var tweet = document.getElementById('tweet');
var clone = tweet.cloneNode(true); // "deep" clone
tweet.parentNode.appendChild(clone);
}

   $(document).ready(function() {
  $("p").html(function(_, html) {
    return html.replace(/(\#\w+)/g, '<span class="hashtag">$1</span>');
  });
});

$(document).ready(function() {
  $("p").html(function(_, html) {
    return html.replace(/(\@\w+)/g, '<span class="mention">$1</span>');
  });
});

$(document).ready(function() {
  $("p").html(function(_, html) {
    return html.replace(/(\https\w+)/g, '<a class="mention" href="$1">Link</a>');
  });
});

   $(document).ready(function() {
   $("p").html(function(_, html) {
   return html.replace(/&amp;/g, "&")
         .replace(/&lt;/g, "<")
         .replace(/&gt;/g, ">")
         .replace(/&quot;/g, "\"")
         .replace(/&#39;/g, "\'" );
  });
  });



</script>
<div class="footer">
    <a href="https://twitter.com/contactanimeshs">Built by Animesh</a>
    <a href="https://twitter.com/contactanimeshs">Find me on Twitter <i class="bi bi-twitter"></i></a>
    <a href="https://github.com/contactanimeshs/twinimal">View on GitHub <i class="bi bi-github"></i></a>
</div>
</body>
</html>